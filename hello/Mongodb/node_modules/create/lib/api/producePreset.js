// eslint-disable-next-line @eslint-community/eslint-comments/disable-enable-pair
/* eslint-disable @typescript-eslint/unified-signatures */
import { runPreset } from "../runners/runPreset.js";
import { createNativeSystems } from "../system/createNativeSystems.js";
import { produceBase } from "./produceBase.js";
export async function producePreset(preset, { options, optionsAugment, ...providedSystem }) {
    const { system, take } = createNativeSystems(providedSystem);
    // From engine/apis/producers.md > `optionsAugment`,
    // Preset options are generated through three steps...
    // 1. Any options provided by producePreset's second parameter's options
    const providedOptions = options ?? {};
    // 2. Calling the Preset's Base's produce method, if it exists
    const producedOptions = await produceBase(preset.base, {
        options: providedOptions,
        ...system,
    });
    // 3. Calling to an optional optionsAugment method of producePreset's second parameter
    const optionsForAugmentation = {
        ...producedOptions,
        ...providedOptions,
    };
    const augmentedOptions = await optionsAugment?.(optionsForAugmentation);
    return runPreset(preset, {
        ...optionsForAugmentation,
        ...augmentedOptions,
    }, {
        ...system,
        take,
    });
}
//# sourceMappingURL=producePreset.js.map