import { withoutUndefinedProperties } from "without-undefined-properties";
// TODO: move into separate package?
export async function awaitLazyProperties(source) {
    const result = {};
    const tasks = [];
    for (const [key, creator] of Object.entries(source)) {
        if (typeof creator !== "function") {
            result[key] = creator;
            continue;
        }
        const task = creator();
        if (task instanceof Promise) {
            tasks.push(task.then((awaited) => {
                result[key] = awaited;
            }));
        }
        else if (task !== undefined) {
            result[key] = task;
        }
    }
    await Promise.all(tasks);
    return withoutUndefinedProperties(result);
}
//# sourceMappingURL=awaitLazyProperties.js.map